# ========================================
# GetInMotion Production Environment
# Docker Compose Configuration
# ========================================
# Copy this file to .env and update with your actual values
# NEVER commit the actual .env file — it contains secrets

# ========================================
# IMAGE CONFIGURATION
# ========================================
# Tag of the GHCR images to pull.
# Defaults to "main" if not set (matches the CI branch tag).
# To pin a specific commit: IMAGE_TAG=sha-a1b2c3d
IMAGE_TAG=main

# ========================================
# API SERVICE (NestJS)
# ========================================
API_PORT=3040
NODE_ENV=production
ENVIRONMENT_PROJECT=prod

# Lightsail Managed PostgreSQL — NOT "postgres" (no container in prod)
HOST_DB=ls-xxxx.xxxx.us-east-1.rds.amazonaws.com
PORT_DB=5432
USER_DB=dbadmin
PASS_DB=change_this_to_your_lightsail_db_password
NAME_DB=getinmotion

PASSWORD_SECRET=change_this_jwt_secret_at_least_64_characters_long_use_openssl_rand_hex_32
OPENAI_API_KEY=sk-your-openai-api-key-here

# ========================================
# CDN / IMAGE STORAGE
# ========================================
# Production S3 bucket base URL for image assets
CDN_BASE_URL=https://telar-prod-bucket.s3.us-east-1.amazonaws.com

# ========================================
# GOOGLE OAUTH
# ========================================
# Authorized redirect URI must be registered in Google Cloud Console
# Get from: https://console.cloud.google.com → APIs & Services → Credentials
GOOGLE_CLIENT_ID=your_google_client_id_here
GOOGLE_CLIENT_SECRET=your_google_client_secret_here
GOOGLE_CALLBACK_URL=https://api.yourdomain.com/telar/server/auth/google/callback

# ========================================
# AGENTS SERVICE (Python/FastAPI)
# ========================================
AGENTS_PORT=8000
OPENAI_MODEL=gpt-4o
EMBEDDING_MODEL=text-embedding-3-small
EMBEDDING_DIMENSIONS=1536

# Supabase Configuration
SUPABASE_URL=https://your-project-id.supabase.co
SUPABASE_SERVICE_ROLE_KEY=your_supabase_service_role_key_here
# Use the Lightsail DB endpoint for the agents service DB connection
SUPABASE_DB_URL=postgresql://dbadmin:your_db_password@ls-xxxx.rds.amazonaws.com:5432/getinmotion?sslmode=require

# API Security
API_SECRET_KEY=your_secret_key_here_generate_with_openssl_rand_hex_32

# Server Configuration
HOST=0.0.0.0
LOG_LEVEL=info

# LangSmith (Optional)
LANGSMITH_API_KEY=
LANGSMITH_PROJECT=artisan-agents-prod
LANGSMITH_TRACING=false

# Tavily Web Search
TAVILY_API_KEY=your_tavily_api_key_here

# Agent Configuration
MAX_RETRIES=3
REQUEST_TIMEOUT=60
RAG_TOP_K=5
CHUNK_SIZE=1000
CHUNK_OVERLAP=200
MAX_BATCH_SIZE=100

# Memory Configuration
MEMORY_RETRIEVAL_LIMIT=10
MEMORY_IMPORTANCE_THRESHOLD=0.5
PROFILE_UPDATE_INTERVAL=5
CONVERSATION_SUMMARY_INTERVAL=10

# ========================================
# PAYMENT SERVICE (Go) — Production
# ========================================
PAYMENT_SERVICE_NAME=gim-payment-svc
PAYMENT_ENVIRONMENT=production
PAYMENT_PORT=8090
PAYMENT_SQL_DRIVER=pgx
# Use Lightsail DB endpoint; sslmode=require for managed DB
PAYMENT_SQL_DATA_SOURCE=postgres://dbadmin:your_db_password@ls-xxxx.rds.amazonaws.com:5432/payment_db?sslmode=require

# Cobre Payment Gateway
COBRE_API_KEY=your_cobre_api_key
COBRE_API_SECRET=your_cobre_api_secret
COBRE_BALANCE_ID=your_cobre_balance_id
COBRE_URL=https://api.cobre.co

# Wompi Payment Gateway — Production (not sandbox)
WOMPI_BASE_URL=https://production.wompi.co/v1
WOMPI_PRIVATE_KEY=your_wompi_production_private_key
WOMPI_EVENTS_SECRET=your_wompi_events_secret

# ========================================
# FRONTEND PORTS (internal — Nginx proxies these)
# ========================================
ARTISANS_WEB_PORT=3000
MARKETPLACE_WEB_PORT=3001

# ========================================
# NOTE: VITE_* frontend build variables are NOT in this file.
# They are baked into the Docker images at CI build time using
# PROD_* GitHub secrets. See .github/workflows/build-and-push-prod.yml.
# ========================================
